---
title: "Urbanization, energy consumption, and CO2 emissions with different income level countries"
author:
- familyname: Cui
  othernames: Di
  address: Monash University
  email: dcui0002@student.monash.edu
  correspondingauthor: true
  qualifications:  Master of Business Analytics
- familyname: Chen
  othernames: Guanru
  address: Monash University
  email: gche0054@student.monash.edu
  correspondingauthor: true
  qualifications: Master of Business Analytics
- familyname: Chen
  othernames: Yunzhi
  address: Monash University
  email: yche0537@student.monash.edu
  correspondingauthor: true
  qualifications:  Master of Business Analytics
department: TGIF \newline Di Cui &\newline Guanru Chen &\newline Yunzhi Chen
organization: World Bank
bibliography: references.bib
biblio-style: authoryear-comp
linestretch: 1.5
output:
  bookdown::pdf_document2:
    template: monashreport2.tex
    fig_caption: yes
    fig_height: 5
    fig_width: 8
    includes:
      in_header: preamble.tex
    keep_tex: yes
    number_sections: yes
    citation_package: biblatex
    toc: false
editor_options: 
  chunk_output_type: console
---

```{r , echo = FALSE, message = FALSE, warning = FALSE}
# Libraries

library(tidyverse)
library(readr)
library(kableExtra)
library(bookdown)
library(gridExtra)
library(viridis)
library(scales)
```

# Data set introduction



# Research questions



\clearpage

# Exploratory data analysis

\section*{}



\subsection*{Analysis} 


\clearpage

\section*{Brief about Meat Production}

- What's the production distribution of different livestock types across the world?

- Which countries are main production country for?

\subsection*{Research Question}

```{r load-data, echo = FALSE , message = FALSE, warning = FALSE}
GD <- read_csv(file = "Data/global-meat-production.csv")
MT <- read_csv(file = "Data/global-meat-production-by-livestock-type.csv")
```

## Q1
```{r production, echo = FALSE , message = FALSE, warning = FALSE}
production <- GD %>%
  select(-Code) %>% 
  filter(Entity %in% c("Asia",
                       "Europe",
                       "Northern America",
                       "South America",
                       "Central America",
                       "Africa",
                       "Oceania")) %>%
    rename("Production"= "Livestock Primary - Meat, Total - 1765 - Production - 5510 - tonnes") %>%
    group_by(Entity, Year)

plt_pd<- ggplot(production, aes(x= Year,
                                y= Production, 
                                fill= Entity)) + 
    geom_area(alpha=0.6 , size=.5, colour="white")+
    scale_fill_viridis(discrete = T) +
    theme_minimal()+
    ggtitle("Global meat production, 1961 to 2018")+
    scale_y_continuous(labels = comma_format(big.mark = ","))

ggplotly(plt_pd)
```


## Q1
```{r production_type, echo = FALSE , message = FALSE, warning = FALSE, fig.cap = "Comparison of the urbanization development"}
pt_world <- MT %>%
  select(-Code) %>% 
  rename("Sheep & Goat"= "Livestock Primary - Sheep and Goat Meat - 1807 - Production - 5510 - tonnes",
         "Beef & Buffalo"= "Livestock Primary - Beef and Buffalo Meat - 1806 - Production - 5510 - tonnes",
         "Pig"= "Livestock Primary - Meat, pig - 1035 - Production - 5510 - tonnes",
         "Wild Game"= "Livestock Primary - Meat, game - 1163 - Production - 5510 - tonnes",
         "Duck"= "Livestock Primary - Meat, duck - 1069 - Production - 5510 - tonnes",
         "Poltry"= "Livestock Primary - Meat, Poultry - 1808 - Production - 5510 - tonnes",
         "Horse"= "Livestock Primary - Meat, horse - 1097 - Production - 5510 - tonnes",
         "Camel"= "Livestock Primary - Meat, camel - 1127 - Production - 5510 - tonnes",
         "Goose & Guinea fowl"= "Livestock Primary - Meat, goose and guinea fowl - 1073 - Production - 5510 - tonnes") %>%
  filter(Entity== "World") %>% 
    group_by(Entity, Year)

pt_world_long <- pt_world %>% 
  pivot_longer(cols= "Sheep & Goat":"Goose & Guinea fowl",
               names_to= "Type",
               values_to = "Amount")

plt_type<- ggplot(pt_world_long, aes(x= Year,
                                    y= Amount, 
                                    fill= Type))+ 
    geom_area(alpha=0.6 , size=.5, colour="white")+
    scale_fill_viridis(discrete = T) +
    theme_minimal()+
    ggtitle("Global meat production by livestock type, 1961 to 2018")+
    scale_y_continuous(labels = comma_format(big.mark = ",", decimal.mark = "."))

plt_type2<- ggplot(pt_world_long, aes(x= Year,
                                     y= Amount,
                                     group= Type,
                                     fill= Type))+
    geom_area() +
    scale_fill_viridis(discrete = TRUE) +
    theme(legend.position="none") +
    ggtitle("Global meat production by livestock type, 1961 to 2018") +
    theme_minimal() +
    theme(
      legend.position="none",
      panel.spacing = unit(0.1, "lines"),
      strip.text.x = element_text(size = 8)
    ) +
    facet_wrap(~ Type, scale="free_y")

grid.arrange(plt_type, plt_type2, nrow= 1)
```


In figure \@ref(fig:production_type), we see that the dominant livestock types are poultry, cattle (which includes beef and buffalo meat), pig, and sheep & goat to a lesser extent at global level.

Although production of all major meat types have been increasing in absolute terms, in relative terms the share of global meat types have changed significantly over the last 50 years. In 1961, poultry meat accounted for small portion; by 2013 its share has tripled. In comparison, beef and buffalo meat as a share of total meat production has nearly halved. And the Pigmeat’s share has remained more constant.


\clearpage

## Q2
```{r tidydata}
pd_type <- MT %>%
  select(-Code) %>% 
  rename("Sheep & Goat"= "Livestock Primary - Sheep and Goat Meat - 1807 - Production - 5510 - tonnes",
         "Beef & Buffalo"= "Livestock Primary - Beef and Buffalo Meat - 1806 - Production - 5510 - tonnes",
         "Pig"= "Livestock Primary - Meat, pig - 1035 - Production - 5510 - tonnes",
         "Wild Game"= "Livestock Primary - Meat, game - 1163 - Production - 5510 - tonnes",
         "Duck"= "Livestock Primary - Meat, duck - 1069 - Production - 5510 - tonnes",
         "Poultry"= "Livestock Primary - Meat, Poultry - 1808 - Production - 5510 - tonnes",
         "Horse"= "Livestock Primary - Meat, horse - 1097 - Production - 5510 - tonnes",
         "Camel"= "Livestock Primary - Meat, camel - 1127 - Production - 5510 - tonnes",
         "Goose & Guinea fowl"= "Livestock Primary - Meat, goose and guinea fowl - 1073 - Production - 5510 - tonnes") %>%
    group_by(Entity, Year) %>%
    pivot_longer(cols= "Sheep & Goat":"Goose & Guinea fowl",
               names_to= "Type",
               values_to = "Amount")
```

```{r cattle}
pd_cattle <- pd_type %>% 
    filter(Type == "Beef & Buffalo") %>% 
    group_by(Entity) %>% 
    summarise(Total= sum(Amount))%>% 
    arrange(-Total)

kable(head(pd_cattle, 20), caption = "Beef and buffalo (cattle) meat production, 1961-2018", booktabs = T)%>%
kable_material(c("striped", "hover"), position = "center") 
```

```{r poultry}
pd_poultry <- pd_type %>% 
    filter(Type == "Poultry") %>% 
    group_by(Entity) %>% 
    summarise(Total= sum(Amount))%>% 
    arrange(-Total)

kable(head(pd_cattle, 20), caption = "Beef and buffalo (cattle) meat production, 1961-2018", booktabs = T)%>%
kable_material(c("striped", "hover"), position = "center")
```

```{r pigmeat}
pd_pigmeat <- pd_type %>% 
    filter(Type == "Pig") %>% 
    group_by(Entity) %>% 
    summarise(Total= sum(Amount))%>% 
    arrange(-Total)

kable(head(pd_pigmeat, 20), caption = "Beef and buffalo (cattle) meat production, 1961-2018", booktabs = T)%>%
kable_material(c("striped", "hover"), position = "center")
```

In the table \@ref(tab:cattle), we see the global production of cattle (beef and buffalo) meat. From the country's perspective, The United States is the world’s largest beef and buffalo meat producer. Other major producers are Brazil and China.

In the table \@ref(tab:cattle), we can see the production of poultry, like cattle production, the United States is still the world’s largest producer. China and Brazil are also large poultry producers. Collectively, Europe is also a major poultry producer, just below the United States.

But for pigmeat production, China dominates global output, producing just short of half of total pigmeat. The other major producers include the United States, Germany.
\clearpage

# Conclusion


\section*{Citation}
The data set is cited from @Worldbank.

Analysis of the data is done using the following packages:

bookdown @bookdown1, @bookdown2,

tidyverse @tidyverse,

readr @readr,

kableExtra @kableExtra.