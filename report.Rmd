---
title: "Urbanization, energy consumption, and CO2 emissions with different income level countries"
author:
- familyname: Cui
  othernames: Di
  address: Monash University
  email: dcui0002@student.monash.edu
  correspondingauthor: true
  qualifications:  Master of Business Analytics
- familyname: Chen
  othernames: Guanru
  address: Monash University
  email: gche0054@student.monash.edu
  correspondingauthor: true
  qualifications: Master of Business Analytics
- familyname: Chen
  othernames: Yunzhi
  address: Monash University
  email: yche0537@student.monash.edu
  correspondingauthor: true
  qualifications:  Master of Business Analytics
department: TGIF \newline Di Cui &\newline Guanru Chen &\newline Yunzhi Chen
organization: World Bank
bibliography: references.bib
biblio-style: authoryear-comp
linestretch: 1.5
output:
  bookdown::pdf_document2:
    template: monashreport2.tex
    fig_caption: yes
    fig_height: 5
    fig_width: 8
    includes:
      in_header: preamble.tex
    keep_tex: yes
    number_sections: yes
    citation_package: biblatex
    toc: false
---

```{r , echo = FALSE, message = FALSE, warning = FALSE}
# Libraries

library(tidyverse)
library(readr)
library(kableExtra)
library(bookdown)
library(gridExtra)
```

# Data set introduction



# Research questions



\clearpage

# Exploratory data analysis

\section*{Global meat production -- Di Cui}

```{r read-data1, echo = FALSE, message = FALSE, warning = FALSE}
global_production <-read.csv(here::here("Data/global-meat-production.csv"))
production <- read.csv(here::here("Data/meat-production-tonnes.csv"))
```

\subsection*{Analysis} 

**Q1: How does global meat production develop from 1961 to 2018?**

```{r tidy-data, echo = FALSE, message = FALSE, warning = FALSE}

global_production <- global_production %>%
  rename("meat_production" = "Livestock.Primary...Meat..Total...1765...Production...5510...tonnes") %>%
  mutate(meat_production = round(meat_production/1000000, digits = 2)) %>%
  filter(Entity %in% c("Oceania", "Africa", "Central America", "South America", "Northern America", "Europe", "Asia")) 


df <- global_production %>%
  group_by(Entity) %>%
  mutate(meat_sum = sum(meat_production)) %>%
  ungroup() %>%
  arrange(meat_sum) 

df <- df %>%
  mutate(Entity = factor(Entity, unique(Entity))) %>%
  group_by(Year) %>%
  mutate(total = sum(meat_production))

 
```

```{r continent-figure, echo = FALSE, message = FALSE, warning = FALSE, fig.cap="Global meat production from 1961 to 2018"}
ggplot(df, aes(x = Year, y = meat_production, color = Entity))+
  geom_line()+
  scale_fill_brewer(palette = "Set3")+
  scale_x_continuous(breaks = c(1961,1970,1980, 1990, 2000, 2010,2018))+
  scale_y_continuous(breaks = c(0, 10, 50, 100, 150))+
  ylab("livestock meat production (million tonnes)")+
  theme_bw()
```  

From Figure\@ref(fig:continent-figure), we can see all continents show an uptrend. In particular, Asia production increased from under 10 million tonnes to around 150 million tonnes, and produced more meat than Europe in 1992, and become the largest meat production continent. And Europe shows a fluctuating growth, while another continents show steady growth.

\clearpage

**Q2:  How do the Top six countries of meat production develop from 1961 to 2018?**

```{r tidy-data2, echo = FALSE, message = FALSE, warning = FALSE}

production <- production %>%
   rename("meat_production" = "Livestock.Primary...Meat..Total...1765...Production...5510...tonnes") %>%
  mutate(meat_production = round(meat_production/1000000, digits = 2)) 

df2 <- production %>%
  group_by(Entity) %>%
  mutate(meat_sum = sum(meat_production)) %>%
  ungroup() %>%
  arrange(-meat_sum) 

df2 <- df2 %>%
  filter(Code != "" &
        Code %in% c("CHN", "USA", "BRA", "DEU", "FRA", "ARG"))
 

```


```{r country, echo = FALSE, message = FALSE, warning = FALSE, fig.cap="Top six countries' meat production from 1961 to 2018"}

ggplot(df2, aes(x = Year, y = meat_production, color = Entity))+
  geom_line()+
  scale_fill_brewer(palette = "Set3")+
  scale_x_continuous(breaks = c(1961,1970,1980, 1990, 2000, 2010,2018))+
  ylab("Top 6 countries of livestock meat production (million tonnes)")+
  theme_bw()

  
```

From Figure\@ref(fig:country), it is obvious that China meat production has increased sharply. And China surpassed the United States in 1990 and became the largest meat production country in the world at the same time. 

\clearpage





\section*{Citation}
The data set is cited from @meatproduction.

Analysis of the data is done using the following packages:

bookdown @bookdown1, @bookdown2,

tidyverse @tidyverse,

readr @readr
