---
title: "Urbanization, energy consumption, and CO2 emissions with different income level countries"
author:
- familyname: Cui
  othernames: Di
  address: Monash University
  email: dcui0002@student.monash.edu
  correspondingauthor: true
  qualifications:  Master of Business Analytics
- familyname: Chen
  othernames: Guanru
  address: Monash University
  email: gche0054@student.monash.edu
  correspondingauthor: true
  qualifications: Master of Business Analytics
- familyname: Chen
  othernames: Yunzhi
  address: Monash University
  email: yche0537@student.monash.edu
  correspondingauthor: true
  qualifications:  Master of Business Analytics
department: TGIF \newline Di Cui &\newline Guanru Chen &\newline Yunzhi Chen
organization: World Bank
bibliography: references.bib
biblio-style: authoryear-comp
linestretch: 1.5
output:
  bookdown::pdf_document2:
    template: monashreport2.tex
    fig_caption: yes
    fig_height: 5
    fig_width: 8
    includes:
      in_header: preamble.tex
    keep_tex: yes
    number_sections: yes
    citation_package: biblatex
    toc: false
---

```{r , echo = FALSE, message = FALSE, warning = FALSE}
# Libraries

library(tidyverse)
library(readr)
library(kableExtra)
library(bookdown)
library(gridExtra)
```

# Data set introduction



# Research questions


\clearpage

# Exploratory data analysis

\clearpage

\section*{Per capita meat consumption}

```{r read-data, echo = FALSE, message = FALSE}
# Read data
meat_consumption_total <- read.csv(here::here("Data/meat-supply-per-person.csv"))
meat_consumption_type <- read.csv(here::here("Data/per-capita-meat-consumption-by-type-kilograms-per-year.csv"))
meat_consumption <- meat_consumption_type %>% left_join(meat_consumption_total) %>%
  rename(Country = Entity,
         Mutton_Goat = Mutton...Goat.meat.food.supply.quantity..kg.capita.yr...FAO..2020.,
         Other_meats = Meat..Other..Food.supply.quantity..kg.capita.yr...FAO..2020.,
         Poultry = Poultry.meat.food.supply.quantity..kg.capita.yr...FAO..2020.,
         Pork = Pigmeat.food.supply.quantity..kg.capita.yr...FAO..2020.,
         Beef_Bufallo = Bovine.meat.food.supply.quantity..kg.capita.yr...FAO..2020.,
         Total_consumption_kg_capita_yr = Meat.food.supply.quantity..kg.capita.yr...FAO..2020.) %>%
  na_if("") %>%
  filter(complete.cases(Code)) %>%
  filter(Country != "Hong Kong" & Country != "Taiwan")

```

\subsection*{Analysis}

**Which countries eat the most meat in the last 20 years? **

As can be seen from the Table \@ref(tab:highest-meanconsumption) below, the top six countries with the highest average meat consumption mean in the world over the 20-year period from 1997 to 2017 are the United States, Australia, New Zealand, Spain, French Polynesia and Bahamas. The highest per capita meat consumption mean of the United States reached about 121.2 kg/capita/year. It can be concluded that countries with high income also consume more meat.

```{r highest-meanconsumption, echo = FALSE}

highest_meanconsumption <- meat_consumption %>% 
                 filter(Year >= 1997) %>%
                 group_by(Country) %>%
                 summarise(Mean_consumption_kg_capita_yr = mean(Total_consumption_kg_capita_yr)) %>%
                 arrange(desc(Mean_consumption_kg_capita_yr)) %>%
                 select(Country, Mean_consumption_kg_capita_yr)

table_data2 <- head(highest_meanconsumption, 6)

knitr::kable(table_data2,
             caption = "Top 6 countries with the largest mean of meat consumption over years", digits = 2) 
```
\clearpage

In terms of changing trends, compared with world, figure \@ref(fig:highest-consumption-trend) shows the meat consumption per person in these countries over the last 20 years have fluctuated considerably, with the exception of Australia and the United States, where consumption has increased, while all other countries have shown a decreasing trend, but the total value is still much higher than the world per capita meat consumption.

```{r highest-consumption-trend, echo = FALSE, fig.cap = "Consumption trend of top 6 countries"}
highest_consumption_trend <- meat_consumption %>% 
             filter(Year >= 1997) %>%
             filter(Country %in% c("United States", 
                                   "Australia", 
                                   "New Zealand", 
                                   "Spain", 
                                   "French Polynesia", 
                                   "Bahamas",
                                   "World")) 

ggplot(highest_consumption_trend, 
      aes(x = Year, 
          y = Total_consumption_kg_capita_yr, 
          color = Country)) + #color = Country
 geom_line()  #+ scale_fill_brewer(palette = "Dark2")

```

\clearpage


# Visualization of urbanization, energy consumption, and CO2 emissions with different income level countries



# Conclusion


\section*{Citation}
The data set is cited from @owidmeatproduction.

Analysis of the data is done using the following packages:

bookdown @bookdown1, @bookdown2,

tidyverse @tidyverse,

readr @readr,

kableExtra @kableExtra.