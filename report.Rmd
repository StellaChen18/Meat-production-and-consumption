---
title: "Urbanization, energy consumption, and CO2 emissions with different income level countries"
author:
- familyname: Cui
  othernames: Di
  address: Monash University
  email: dcui0002@student.monash.edu
  correspondingauthor: true
  qualifications:  Master of Business Analytics
- familyname: Chen
  othernames: Guanru
  address: Monash University
  email: gche0054@student.monash.edu
  correspondingauthor: true
  qualifications: Master of Business Analytics
- familyname: Chen
  othernames: Yunzhi
  address: Monash University
  email: yche0537@student.monash.edu
  correspondingauthor: true
  qualifications:  Master of Business Analytics
department: TGIF \newline Di Cui &\newline Guanru Chen &\newline Yunzhi Chen
organization: World Bank
bibliography: references.bib
biblio-style: authoryear-comp
linestretch: 1.5
output:
  bookdown::pdf_document2:
    template: monashreport2.tex
    fig_caption: yes
    fig_height: 5
    fig_width: 8
    includes:
      in_header: preamble.tex
    keep_tex: yes
    number_sections: yes
    citation_package: biblatex
    toc: false
---

```{r , echo = FALSE, message = FALSE, warning = FALSE}
# Libraries

library(tidyverse)
library(readr)
library(kableExtra)
library(bookdown)
library(gridExtra)
```

# Data set introduction

At the World Bank, the Development Data Group coordinates statistical and data work and maintains a number of macro, financial and sector databases. The data set that we used was obtained from the World Bank database. This report explores the variation in data for six countries in different income groups by focusing on three variables of the data set: CO2 emissions (metric tons per capita), urban population and energy use (kg of oil equivalent per capita).

The CO2 emissions refers to annual anthropogenic emissions from data on fossil fuel consumption and world cement manufacturing. 

Urban population refers to people living in urban areas as defined by national statistical offices. 

Total energy use includes energy usage from combustible renewable and waste - solid biomass and animal products, gas and liquid from biomass, and industrial and municipal waste. 

More information available \href{https://data.worldbank.org/}{here}.

# Research questions

- For China and India, which country has more CO2 emissions per capita during 1960 to 2020?

- How did the CO2 emissions per capita of China and India develop from 1960 to 2020?

- How's the development of urbanization of the two selected countries of two types of income group:
    
    1. Ethiopia: Low income.
    2. Italy: High income

- Would the situation be similar with the other income group countries.
    
    Is the situation similar with the status of observation from last question.

- Overall energy use kg of oil_equivalent per capita in Belgium and Turkey from 1960 to 2015.

- The trend in energy use kg of oil_equivalent per capita of Belgium and Turkey from 1960 to 2015.

\clearpage

# Exploratory data analysis

\section*{Country China and India}

```{r read-data1, echo = FALSE, message = FALSE, warning = FALSE}
data<- read.csv(here::here("Data/Assignment3_data.csv")) %>%
  filter(Country_Name == "China" | Country_Name == "India")
```

\subsection*{Analysis} 

**Q1:**

```{r co2table, echo = FALSE, message = FALSE, warning = FALSE}
data %>%
  group_by(Country_Name) %>%
  summarise(mean = mean(CO2_emissions_metric_tons_per_capita, na.rm = TRUE), 
            median = median(CO2_emissions_metric_tons_per_capita, na.rm = TRUE)) %>%
  knitr::kable(caption = "The mean and median of CO2 emissions(metric tones per capita) in China and India ")
```

In table\@ref(tab:co2table), we observe the mean and median of CO2 emissions per capita in China are all higher than the mean and median in India. The mean and median in China are all over 2 metric tons. However, the mean and median in India are all under 1 metric tons.

**Q2:**

```{r co2trend, echo = FALSE, message = FALSE, warning = FALSE, fig.cap="The CO2 emissions(metric tones per capita) in China and India"}

data %>%
  ggplot(aes(x = Year, y = CO2_emissions_metric_tons_per_capita, color = Country_Name)) +
  geom_line(aes(group = Country_Name))+
  scale_x_continuous(breaks = seq(1960,2020,10))+
  labs(y = "CO2 emissions(metric tones per capita)", color = "Country Name")+
  facet_wrap(~IncomeGroup, ncol = 1, scales = "free_y")

  
```

Figure\@ref(fig:co2trend) shows the uptrend development of CO2 emissions per capita in China and India. In China, the number of CO2 emissions per capita decreased after 1960, but the number has increased from 1970 and raised sharply from 2000, and the number has arrived at around 6.5 metric tons in 2010. In India, although the number increased all the time, the number was always under 2 metric tons.

\clearpage

\section*{Country Ethiopia and Italy}

\subsection*{Exploratory data analysis}

```{r read-data2, echo = FALSE , message = FALSE, warning = FALSE}

raw <- read_csv(file = "Data/Assignment3_data.csv")
```

```{r tab2, echo = FALSE , message = FALSE, warning = FALSE}
comparison <- raw %>%
  dplyr::filter(Country_Name %in% c("Ethiopia","Italy")) %>%
         group_by(Country_Name, Year) %>%
         rename(Country = Country_Name) %>% 
         summarize_at(vars(Urban_population), list(sum), na.rm = TRUE)

comparison_wide <- comparison %>% 
  pivot_wider(names_from = Country,
              values_from = Urban_population) %>% 
  filter(Year >= 1999)  
  
  
kable(comparison_wide, caption = "Urban population per year of Ethiopia and Italy from 1999-2018", booktabs = T) %>%
kable_material(c("striped", "hover"), position = "center")
```

Because the data is across over 40 years, which is a bit longer to present. So in Table \@ref(tab:tab2) we extract the urban population of two countries since 1999. And noticeably, the urban population of Ethiopia is lower than Italy throughout the whole period.

```{r fig2, echo = FALSE , message = FALSE, warning = FALSE, fig.cap = "Comparison of the urbanization development"}
ET2 <- raw %>%
          dplyr::filter(Country_Name %in% c("Ethiopia",
                                            "Italy")) %>%
                 rename(Country = Country_Name) %>%
ggplot(aes(x = Year,
           y = Urban_population,
           fill = Country) ) +
  geom_bar(stat="identity", position=position_dodge()) +
  scale_fill_viridis_d(direction = 1) +
  theme_bw()

ET3 <- raw %>%
          dplyr::filter(IncomeGroup %in% c("Low income",
                                           "High income")) %>%
                 
ggplot(aes(x = Year,
           y = Urban_population,
           fill = IncomeGroup) ) +
  geom_bar(stat="identity", position=position_dodge()) +
  scale_fill_viridis_d(direction = -1) +
  theme_bw()

grid.arrange(ET2, ET3, nrow = 2)
```


In figure \@ref(fig:fig2) we observe the level of urbanization in Ethiopia is still strong, but on the other hand, Italy is quite stable. And we observe the similar trend in the plot of income group.

Based on this finding, we may conclude that the level of urbanization of the country may be significantly affected by its development of economic and its state income.

\clearpage

\section*{Country Belgium and Turkey}

```{r read-data, echo = FALSE}
# Read data
energyuse <- read.csv("Data/Assignment3_data.csv") %>%
             filter(Country_Name %in% c("Belgium", "Turkey")) %>%
             filter(complete.cases(Energy_use_kg_of_oil_equivalent_per_capita)) %>%
             select(-CO2_emissions_metric_tons_per_capita, -Urban_population)

```

\subsection*{Analysis}

**The total energy use of Belgium and Turkey**

From 1960 to 2015, the total energy use of Belgium is 258677.63 kg of oil_equivalent per capita, while it is 51666.23 kg in Turkey. See Table \@ref(tab:energyuse-Tot).

```{r energyuse-Tot, echo = FALSE}
energyuse_Tot <- energyuse %>% 
                 group_by(Country_Name) %>%
                 summarise(Total_energy_use = sum(Energy_use_kg_of_oil_equivalent_per_capita))
knitr::kable(energyuse_Tot, 
             caption = "Total energy use of Belgium and Turkey",
             digits = 2)
```

**The trend**

Figure \@ref(fig:trend) shows the trend of the energy use kg of oil_equivalent per capita in Belgium and Turkey. In general, energy use kg of oil_equivalent per capita in both countries shows an upward trend over the 55-year period, but Belgium's energy use is much higher than Turkey's. Belgium shows a fluctuating upward trend, with a larger increase than Turkey, while Turkey shows a steady upward trend.

```{r trend, fig.cap= "Energy use of Belgium and Turkey", echo=FALSE}
ggplot(energyuse, aes(x = Year, 
                          y = Energy_use_kg_of_oil_equivalent_per_capita,
                      color = Country_Name)) +
geom_line() + theme() + 
  scale_x_continuous(
    breaks = seq(min(energyuse$Year),
                 max(energyuse$Year), by=10)) +
  facet_wrap(~IncomeGroup, ncol = 1)
```

# Visualization of urbanization, energy consumption, and CO2 emissions with different income level countries

```{r co2-conclusion, echo = FALSE, message = FALSE, warning = FALSE, fig.cap="The CO2 emissions(metric tones per capita) in six countries"}
co2_conclusion <- read.csv(here::here("Data/Assignment3_data.csv")) %>%
  filter(Country_Name == "China" | Country_Name == "India" |
          Country_Name == "Belgium" | Country_Name == "Turkey" |
          Country_Name == "Ethiopia" | Country_Name == "Italy")

co2_conclusion %>%
  ggplot(aes(x = Year, y = CO2_emissions_metric_tons_per_capita, color = Country_Name)) +
  geom_line(aes(group = Country_Name))+
  scale_x_continuous(breaks = seq(1960,2020,10))+
  labs(y = "CO2 emissions(metric tones per capita)", color = "Country Name")+
    facet_wrap(~IncomeGroup, ncol = 1, scales = "free_y")

```

```{r urbanization, echo = FALSE, fig.align = "center", fig.cap = "The urbanization development of six countries"}

All <- raw %>%
          dplyr::filter(Country_Name %in% c("Ethiopia",
                                            "Italy",
                                            "Belgium",
                                            "Turkey",
                                            "China",
                                            "India")) %>%
                 rename(Country = Country_Name) %>%
  
  ggplot(aes(x = Year, 
             y = Urban_population,
             color = Country) ) +
  geom_line()  +
  facet_wrap(~IncomeGroup, ncol = 1, scales = "free_y") 

All
```

```{r energy-use, echo = FALSE, fig.cap= "Energy use kg of oil_equivalent per capita in six counties"}
energy <- read.csv("Data/Assignment3_data.csv") %>%
             filter(Country_Name %in% c("Belgium", "Turkey", "Ethiopia", "Italy", "China", "India")) %>%
             filter(complete.cases(Energy_use_kg_of_oil_equivalent_per_capita)) %>%
             select(-CO2_emissions_metric_tons_per_capita, -Urban_population)

ggplot(energy, aes(x = Year, 
                          y = Energy_use_kg_of_oil_equivalent_per_capita,
                      color = Country_Name)) +
geom_line() + theme() + 
  scale_x_continuous(
    breaks = seq(min(energyuse$Year),
                 max(energyuse$Year), by=10)) +
  facet_wrap(~IncomeGroup, ncol = 1, scales = "free_y")

```

\clearpage

# Conclusion

To conclude, the graphs illustrate that the three indicators varies accordingly for different classes of income groups,

- About the CO2 emissions, almost all income groups show an uptrend development except for the high income group, which develops steadily. And the number of CO2 emissions in high-income and upper-middle-income countries is always higher than in the other two groups, which is higher than three metric tons in the recent 30 years. However, in other income groups, the number is under two metric tons, especially in the low-income group, the number is under 0.5 metric tons. See Figure \@ref(fig:co2-conclusion).

- From Figure \@ref(fig:urbanization), we can see the urban population of our selected countries all present a steady increasing status. With this kind of explosive growth of cities globally signifies the demographic transition from rural to urban, and is associated with state’s economic activity shifts from an agriculture-based economy to mass industry, technology, and service, which improve the country’s income status.

- Figure \@ref(fig:energy-use) illustrates that energy use has been growing rapidly in low- and middle-income economies, but high-income economies still use almost five times as much energy on a per capita basis.

\section*{Citation}
The data set is cited from @Worldbank.

Analysis of the data is done using the following packages:

bookdown @bookdown1, @bookdown2,

tidyverse @tidyverse,

readr @readr,

kableExtra @kableExtra.